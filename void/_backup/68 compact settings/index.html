<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Void Typeface — Misha Ivanov</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        // Сразу проверить мобильное устройство и скрыть панели до загрузки основного JS
        (function() {
            const width = window.innerWidth;
            const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            const userAgent = navigator.userAgent.toLowerCase();
            const isTablet = /ipad|android(?!.*mobile)|tablet/i.test(userAgent);
            const isMobilePhone = /mobile|iphone|ipod|android.*mobile|blackberry|windows phone/i.test(userAgent);
            const isMobile = (width < 768 && isTouchDevice && !isTablet) || (isMobilePhone && width < 1024);
            
            if (isMobile) {
                document.documentElement.classList.add('is-mobile');
            }
        })();
    </script>
</head>
<body>
    <div class="container">
        <!-- Top Navigation -->
        <div class="top-links">
            <a href="https://mishaivanov.com/void" class="top-link" id="aboutVoidLink">← About Void</a>
            
            <!-- Preset Dropdown -->
            <div class="preset-dropdown" id="presetDropdown">
                <button class="preset-dropdown-toggle" id="presetDropdownToggle" type="button" aria-haspopup="listbox" aria-expanded="false">
                    <span class="preset-dropdown-text">Default</span>
                    <svg class="preset-dropdown-arrow" width="12" height="8" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <ul class="preset-dropdown-menu" id="presetDropdownMenu" role="listbox">
                    <!-- Пресеты будут добавлены динамически -->
                </ul>
            </div>

            <!-- Save Preset Button -->
            <button class="top-link" id="savePresetBtn" type="button" style="display: none;">Save</button>

            <!-- Delete Preset Button -->
            <button class="top-link btn-danger" id="deletePresetBtn" type="button" style="display: none;">Delete</button>
        </div>

        <div class="main-content">
            <!-- Main Canvas -->
            <div class="canvas-container" id="canvasContainer">
                <!-- Alternatives Panel (shown only in editor mode) -->
                <aside class="editor-alternatives-panel" id="editorAlternativesPanel" style="display: none;">
                    <div class="editor-alternatives-header">
                        <span>Alternatives</span>
                    </div>
                    <div class="editor-alternatives-content" id="editorAlternativesContent">
                        <!-- Альтернативы будут добавлены динамически -->
                    </div>
                </aside>
                
                <canvas id="mainCanvas"></canvas>
                <!-- Editor hint (shown only in editor mode) -->
                <div class="editor-hint" id="editorHint" style="display: none;">↑↓ to switch, ←→ to rotate</div>
            </div>

            <!-- General Panel (слева вверху) -->
            <aside class="controls-panel controls-panel-left" id="controlsPanel">
                <div class="panel-header" id="controlsPanelHeader">
                    <span>General</span>
                    <span class="collapse-icon">
                        <svg width="10" height="6" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </span>
                </div>
                <div class="panel-content">
                    <section class="control-section">
                        <!-- Module -->
                        <div class="control-group">
                            <label for="moduleSizeSlider">
                                <span>Module <span class="unit">px</span></span>
                                <input type="text" class="value-display" id="moduleSizeValue" value="24">
                            </label>
                            <input type="range" id="moduleSizeSlider" min="4" max="64" value="24" step="1">
                        </div>

                        <!-- Stem Weight -->
                        <div class="control-group">
                            <label for="stemSlider">
                                <span>Stem Weight <span class="unit">mod</span></span>
                                <input type="text" class="value-display" id="stemValue" value="0.5">
                            </label>
                            <input type="range" id="stemSlider" min="0.1" max="3.0" value="0.5" step="0.1">
                        </div>

                        <!-- Text Controls: Spacing, Line Height, Alignment (compact row) -->
                        <div class="control-group text-controls-row">
                            <!-- Letter Spacing (Tracking) -->
                            <div class="compact-input-group" title="Letter Spacing">
                                <svg class="compact-input-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3,12h10M3,12l2-2M3,12l2,2M13,12l-2-2M13,12l-2,2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M8,3v6M5,3h6" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                                </svg>
                                <input type="number" class="compact-input" id="letterSpacingValue" value="1" min="0" max="16" step="1">
                            </div>
                            
                            <!-- Line Height (Leading) -->
                            <div class="compact-input-group" title="Line Height">
                                <svg class="compact-input-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M4,3.5v9M4,3.5l2,2M4,3.5l-2,2M4,12.5l2-2M4,12.5l-2-2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M11,3.6v8.7M8,3.6h6" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                                </svg>
                                <input type="number" class="compact-input" id="lineHeightValue" value="2" min="0" max="16" step="1">
                            </div>
                            
                            <!-- Text Alignment Icons -->
                            <div class="text-align-icons">
                                <input type="radio" name="textAlign" value="left" id="textAlignLeft" class="sr-only">
                                <label for="textAlignLeft" class="align-icon-btn" title="Align Left">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M2 3H14M2 6.5H10M2 10H12M2 13.5H8" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                                    </svg>
                                </label>
                                
                                <input type="radio" name="textAlign" value="center" id="textAlignCenter" class="sr-only" checked>
                                <label for="textAlignCenter" class="align-icon-btn" title="Align Center">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M2 3H14M4 6.5H12M3 10H13M5 13.5H11" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                                    </svg>
                                </label>
                                
                                <input type="radio" name="textAlign" value="right" id="textAlignRight" class="sr-only">
                                <label for="textAlignRight" class="align-icon-btn" title="Align Right">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M2 3H14M6 6.5H14M4 10H14M8 13.5H14" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                                    </svg>
                                </label>
                            </div>
                        </div>

                        <!-- Text Input -->
                        <div class="control-group">
                            <textarea id="textInput" rows="3" placeholder="Type your text here...">Void
Typeface
Code</textarea>
                        </div>

                    </section>
                </div>
            </aside>

            <!-- Style Panel (справа вверху) -->
            <aside class="controls-panel" id="variabilityPanel">
                <div class="panel-header" id="variabilityPanelHeader">
                    <span>Style</span>
                    <span class="collapse-icon">
                        <svg width="10" height="6" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </span>
                </div>
                <div class="panel-content">
                    <section class="control-section">
                        <!-- Style Toggle -->
                        <div class="control-group">
                            <div class="style-buttons-container">
                                <button type="button" class="style-button active" data-mode="fill" id="modeFill">Monoline</button>
                                <button type="button" class="style-button" data-mode="stripes" id="modeStripes">Stripes</button>
                                <button type="button" class="style-button" data-mode="dash" id="modeDash">Dash</button>
                                <button type="button" class="style-button" data-mode="sd" id="modeSD">Dashed Stripes</button>
                                <button type="button" class="style-button" data-mode="random" id="modeRandom">Random</button>
                            </div>
                        </div>

                        <!-- Lines Number (только для Stripes mode) -->
                        <div class="control-group" id="strokesControlGroup" style="display: none; margin-top: 18px;">
                            <label for="strokesSlider">
                                <span>Lines</span>
                                <input type="text" class="value-display" id="strokesValue" value="2">
                            </label>
                            <input type="range" id="strokesSlider" min="1" max="64" value="2" step="1">
                        </div>

                        <!-- Contrast (только для Stripes mode) -->
                        <div class="control-group" id="strokeGapRatioControlGroup" style="display: none;">
                            <label for="strokeGapRatioSlider">
                                <span>Contrast</span>
                                <input type="text" class="value-display" id="strokeGapRatioValue" value="1.0">
                            </label>
                            <input type="range" id="strokeGapRatioSlider" min="0.1" max="8" value="1.0" step="0.1">
                        </div>

                        <!-- Dash Length (только для Dash mode) -->
                        <div class="control-group" id="dashLengthControlGroup" style="display: none; margin-top: 18px;">
                            <label for="dashLengthSlider">
                                <span>Dash Length</span>
                                <input type="text" class="value-display" id="dashLengthValue" value="0.10">
                            </label>
                            <input type="range" id="dashLengthSlider" min="0.01" max="8" value="0.10" step="0.01">
                        </div>

                        <!-- Gap Length (только для Dash mode) -->
                        <div class="control-group" id="gapLengthControlGroup" style="display: none;">
                            <label for="gapLengthSlider">
                                <span>Gap Length</span>
                                <input type="text" class="value-display" id="gapLengthValue" value="0.30">
                            </label>
                            <input type="range" id="gapLengthSlider" min="0.01" max="8" value="0.30" step="0.01">
                        </div>

                        <!-- Round, Close Ends и Chess -->
                        <div class="control-group toggle-group-row" id="roundedCapsControlGroup" style="display: none;">
                            <label class="checkbox-label" id="roundedCapsLabel" for="roundedCapsCheckbox">
                                <input type="checkbox" id="roundedCapsCheckbox">
                                <span>Round</span>
                            </label>
                            <label class="checkbox-label" id="closeEndsLabel" for="closeEndsCheckbox">
                                <input type="checkbox" id="closeEndsCheckbox">
                                <span>Close</span>
                            </label>
                            <label class="checkbox-label hidden" id="dashChessLabel" for="dashChessCheckboxPD">
                                <input type="checkbox" id="dashChessCheckboxPD">
                                <span>Chess</span>
                            </label>
                        </div>

                        <div class="control-group" id="randomControlGroupStem" style="display: none;">
                            <label>
                                <span>Stem Weight <span class="unit">mod</span></span>
                                <div class="range-value-display">
                                    <input type="text" class="value-display" id="randomStemMinValue" value="0.5">
                                    <span class="range-separator">–</span>
                                    <input type="text" class="value-display" id="randomStemMaxValue" value="1.0">
                                </div>
                            </label>
                            <div id="randomStemRangeSlider" class="range-slider-container"></div>
                        </div>

                        <div class="control-group" id="randomControlGroup2" style="display: none;">
                            <label>
                                <span>Lines</span>
                                <div class="range-value-display">
                                    <input type="text" class="value-display" id="randomStrokesMinValue" value="1">
                                    <span class="range-separator">–</span>
                                    <input type="text" class="value-display" id="randomStrokesMaxValue" value="8">
                                </div>
                            </label>
                            <div id="randomStrokesRangeSlider" class="range-slider-container"></div>
                        </div>

                        <div class="control-group" id="randomControlGroup3" style="display: none;">
                            <label>
                                <span>Contrast</span>
                                <div class="range-value-display">
                                    <input type="text" class="value-display" id="randomContrastMinValue" value="0.5">
                                    <span class="range-separator">–</span>
                                    <input type="text" class="value-display" id="randomContrastMaxValue" value="1.0">
                                </div>
                            </label>
                            <div id="randomContrastRangeSlider" class="range-slider-container"></div>
                        </div>

                        <div class="control-group" id="randomControlGroupDashLength" style="display: none;">
                            <label>
                                <span>Dash Length <span class="unit">mod</span></span>
                                <div class="range-value-display">
                                    <input type="text" class="value-display" id="randomDashLengthMinValue" value="1.0">
                                    <span class="range-separator">–</span>
                                    <input type="text" class="value-display" id="randomDashLengthMaxValue" value="1.5">
                                </div>
                                </label>
                            <div id="randomDashLengthRangeSlider" class="range-slider-container"></div>
                        </div>

                        <div class="control-group" id="randomControlGroupGapLength" style="display: none;">
                            <label>
                                <span>Gap Length <span class="unit">mod</span></span>
                                <div class="range-value-display">
                                    <input type="text" class="value-display" id="randomGapLengthMinValue" value="1.0">
                                    <span class="range-separator">–</span>
                                    <input type="text" class="value-display" id="randomGapLengthMaxValue" value="1.5">
                                </div>
                                </label>
                            <div id="randomGapLengthRangeSlider" class="range-slider-container"></div>
                        </div>

                        <!-- Random Mode Controls: Chaos/Alt/Chess, Round/Close/Dash -->
                        <div class="control-group toggle-group-row" id="randomControlGroup" style="display: none;">
                            <label class="checkbox-label" for="randomFullRandomCheckbox">
                                <input type="checkbox" id="randomFullRandomCheckbox">
                                <span>Chaos</span>
                            </label>
                            <label class="checkbox-label" for="alternativeGlyphsCheckbox">
                                <input type="checkbox" id="alternativeGlyphsCheckbox" checked>
                                <span>Alt</span>
                            </label>
                            <label class="checkbox-label" id="dashChessLabelRandom" for="dashChessCheckboxRandom">
                                <input type="checkbox" id="dashChessCheckboxRandom">
                                <span>Chess</span>
                            </label>
                        </div>
                        <div class="control-group toggle-group-row" id="randomControlGroup4" style="display: none;">
                            <label class="checkbox-label" id="randomRoundedLabel" for="randomRoundedCheckbox">
                                <input type="checkbox" id="randomRoundedCheckbox">
                                <span>Round</span>
                            </label>
                            <label class="checkbox-label" for="randomCloseEndsCheckbox">
                                <input type="checkbox" id="randomCloseEndsCheckbox" checked>
                                <span>Close</span>
                            </label>
                            <label class="checkbox-label" for="randomDashCheckbox">
                                <input type="checkbox" id="randomDashCheckbox">
                                <span>Dash</span>
                            </label>
                        </div>

                        <div class="control-group" id="randomControlGroup5" style="display: none; margin-top: 24px;">
                            <button type="button" class="btn-secondary" id="renewRandomBtn" style="width: 100%;">Update</button>
                        </div>
                    </section>
                </div>
            </aside>

            <!-- View Panel (снизу слева) -->
            <aside class="controls-panel controls-panel-text" id="viewColorsPanel">
                <div class="panel-header" id="viewColorsPanelHeader">
                    <span>View</span>
                    <span class="collapse-icon">
                        <svg width="10" height="6" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </span>
                </div>
                <div class="panel-content">
                    <!-- Color Pickers Group -->
                    <div class="color-pickers-group">
                    <!-- Letter Color -->
                    <div class="control-group">
                        <label>Letter Color</label>
                        <div id="letterColorPickerContainer"></div>
                    </div>

                    <!-- Background Color -->
                    <div class="control-group">
                        <label>Background</label>
                        <div id="bgColorPickerContainer"></div>
                    </div>

                    <!-- Grid Color -->
                        <div class="control-group">
                        <label>Grid Color</label>
                        <div id="gridColorPickerContainer"></div>
                        </div>
                    </div>

                    <!-- Grid, Endpoints and Test Toggles -->
                    <div class="control-group toggle-group-row" style="display: flex;">
                        <label class="checkbox-label" for="showGridCheckbox">
                            <input type="checkbox" id="showGridCheckbox" checked>
                            <span>Grid</span>
                        </label>
                        <label class="checkbox-label" for="showEndpointsCheckbox">
                            <input type="checkbox" id="showEndpointsCheckbox">
                            <span>Ends</span>
                        </label>
                        <label class="checkbox-label" for="showTestCheckbox">
                            <input type="checkbox" id="showTestCheckbox">
                            <span>Pointer</span>
                        </label>
                    </div>

                </div>
            </aside>

            <!-- Editor Panel (вместо Text Panel в режиме Editor) -->
            <aside class="controls-panel controls-panel-editor" id="editorPanel" style="display: none;">
                <div class="panel-content">
                    <section class="control-section">
                        <!-- Character Selector -->
                        <div class="control-group">
                            <label for="editorCharSelector">
                                <span>Character</span>
                            </label>
                            <input type="text" id="editorCharSelector" class="editor-char-input" placeholder="A-Z, 0-9, А-Я" maxlength="1" style="width: 100%; padding: 8px 12px; font-size: 24px; text-align: center; font-family: var(--font-mono); border: 1px solid var(--color-border); border-radius: 4px; background: var(--color-canvas-bg); color: var(--color-text);">
                        </div>
                        
                        <!-- Current Module Info -->
                        <div class="control-group">
                            <div class="editor-module-display" id="editorCurrentModule">S0 (0°)</div>
                        </div>
                        
                        <!-- Glyph String (auto-updating) -->
                        <div class="control-group editor-glyph-string-group">
                            <textarea id="editorGlyphString" rows="2">E0E0E0E0E0 E0E0E0E0E0 E0E0E0E0E0 E0E0E0E0E0 E0E0E0E0E0</textarea>
                        </div>
                        
                        <!-- Save Changes Button -->
                        <div class="control-group editor-save-button-group">
                            <button class="editor-btn" id="editorSaveChangesBtn" type="button" style="display: none;">Save Changes</button>
                        </div>
                        
                        <!-- Move Button -->
                        <div class="control-group editor-save-button-group">
                            <button class="editor-btn" id="editorSaveBtn" type="button">Move ↓</button>
                        </div>
                        
                        <!-- Saved Glyphs Collection -->
                        <div class="control-group editor-saved-glyphs-group">
                            <textarea id="editorSavedGlyphs"></textarea>
                        </div>
                        
                        <!-- Copy Button -->
                        <div class="control-group editor-copy-button-group">
                            <button class="editor-btn" id="editorCopyBtn" type="button">Copy</button>
                        </div>
                    </section>
                </div>
            </aside>

        </div>
    </div>

    <!-- Bottom Action Buttons -->
    <nav class="bottom-buttons">
        <button class="btn-fixed" id="copyBtn">Copy SVG</button>
        <button class="btn-fixed" id="exportBtn">Export SVG ⌘E</button>
        <button class="btn-fixed" id="renewBtn" style="display: none;">Update</button>
    </nav>

    <script type="module" src="js/main.js"></script>
</body>
</html>
